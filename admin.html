<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AllLinguageme Admin</title>
  <style>
    :root { --accent:#ff6a3d; --bg:#f6f6f7; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:var(--bg); }
    .wrap { max-width: 780px; margin: 0 auto; padding: 28px; }
    .card { background:#fff; border-radius:16px; box-shadow: 0 10px 25px rgba(0,0,0,.06); padding: 28px; }
    h1 { margin:0 0 18px; }
    .panel { display:none; }
    .login { display:flex; gap:10px; }
    input[type="password"], input[type="text"] { flex:1; padding:12px 14px; border:1px solid #ddd; border-radius:12px; }
    .btn { padding:12px 16px; border-radius:12px; border:none; font-weight:700; cursor:pointer; }
    .btn.primary { background:var(--accent); color:#fff; }
    pre { background:#f1f3f5; padding:12px; border-radius:10px; overflow:auto; }
    .row { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px; }
    .note { color:#666; font-size:13px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>AllLinguageme Admin</h1>

      <!-- Login -->
      <div id="loginBox" class="login">
        <input id="pin" type="password" placeholder="Skriv inn PIN" />
        <button class="btn primary" id="openBtn">√Öpne</button>
      </div>

      <!-- Panel -->
      <div id="panel" class="panel">
        <div class="row">
          <button class="btn primary" id="dlCsv">‚¨áÔ∏è Last ned som CSV</button>
          <button class="btn" id="clearBtn">üóëÔ∏è T√∏m venteliste</button>
        </div>
        <pre id="output">Ingen registrerte enda.</pre>
        <div class="note">CSV √•pnes i Excel/Google Sheets. P√• mobil kan nedlasting be om bekreftelse.</div>
      </div>
    </div>
  </div>

  <script>
    // Endre PIN her om du vil
    const PIN = "rolf2025";
    const STORAGE_KEY = "allinguageme_waitlist";

    const $ = (id) => document.getElementById(id);
    const loginBox = $("loginBox");
    const panel = $("panel");
    const out = $("output");

    $("openBtn").onclick = () => {
      const p = $("pin").value.trim();
      if (p === PIN) {
        loginBox.style.display = "none";
        panel.style.display = "block";
        loadList();
      } else {
        alert("Feil PIN.");
      }
    };

    function getList(){
      try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]"); }
      catch { return []; }
    }

    function loadList(){
      const list = getList();
      if (!list.length) {
        out.textContent = "Ingen registrerte enda.";
        return;
      }
      // Vis pent
      out.textContent = list
        .map((x,i) => `${i+1}. ${x.name} <${x.email}> ‚Äî ${new Date(x.ts).toLocaleString()}`)
        .join("\n");
    }

    $("clearBtn").onclick = () => {
      if (confirm("Er du sikker p√• at du vil t√∏mme ventelista?")) {
        localStorage.removeItem(STORAGE_KEY);
        loadList();
      }
    };

    // CSV-nedlasting
    $("dlCsv").onclick = () => {
      const list = getList();
      const rows = [["Name","Email","Timestamp"], ...list.map(x => [x.name, x.email, x.ts])];
      const csv = rows.map(r => r.map(v => `"${String(v).replace(/"/g,'""')}"`).join(",")).join("\n");
      const blob = new Blob([csv], { type: "text/csv;charset=utf-8" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "allingguageme-venteliste.csv";
      document.body.appendChild(a);
      a.click();
      a.remove();
    };
  </script>
</body>
</html>
